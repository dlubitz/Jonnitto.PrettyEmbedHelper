/*!
 * Jonnitto.PrettyEmbedHelper - created by Jon Uhlmann
 * @link https://github.com/jonnitto/Jonnitto.PrettyEmbedHelper
 * Copyright 2019-2021 Jon Uhlmann
 * Licensed under GPL-3.0-or-later
 */
!function(){"use strict";var t="jonnitto-prettyembed",e="".concat(t,"--init"),n="".concat(t,"--slim"),o="".concat(t,"--play"),a=Array.from(document.querySelectorAll(".".concat(t,"--video video:not([autoplay])"))),c=Array.from(document.querySelectorAll(".".concat(t,"--audio audio:not([autoplay])"))),i=[].concat(a,c);function r(t){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],c=arguments.length>2?arguments[2]:void 0,i=t.parentNode.classList;if(!i.contains(e))if("function"==typeof c&&c(),t.hasAttribute("data-controls")&&t.setAttribute("controls",!0),t.hasAttribute("controls")||(i.add(n),t.addEventListener("click",(function(){var e=!i.contains(o);i[e?"add":"remove"](o),e?t.play():t.pause()}))),t.hasAttribute("data-streaming")){var r=t.getAttribute("data-streaming");if(t.canPlayType("application/vnd.apple.mpegurl"))t.src=r,u(t,a,i);else if("undefined"==typeof Hls){var l=document.createElement("script");l.src="/_Resources/Static/Packages/Jonnitto.PrettyEmbedHelper/Scripts/Hls.js?v=1",document.head.appendChild(l),l.addEventListener("load",(function(){setTimeout((function(){d(t,r),u(t,a,i)}),100)}))}else d(t,r),u(t,a,i)}else u(t,a,i)}function u(t,n,a){a.add(e),n&&(a.add(o),setTimeout((function(){t.play()}),0))}function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t.forEach((function(t){t!=e&&(t.hasAttribute("controls")||t.parentNode.classList.remove(o),t.pause())}))}function d(t,e){if(Hls.isSupported()){var n=new Hls;n.loadSource(e),n.attachMedia(t)}}function s(t){var e;t||(t={}),window.CustomEvent?e=new CustomEvent("prettyembed",{detail:t}):(e=document.createEvent("CustomEvent")).initCustomEvent("prettyembed",!0,!0,t),document.dispatchEvent(e)}i.forEach((function(t){t.addEventListener("play",(function(t){l(i,t.target)}))}));var f=document.querySelectorAll(".jonnitto-prettyembed--audio audio");function p(t,e){return(t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector).call(t,e)}function m(t,e){document.documentElement.addEventListener("click",(function(n){var o=function(t,e){var n=t;do{if(p(n,e))return n;n=n.parentElement||n.parentNode}while(null!==n&&1===n.nodeType);return null}(n.target,t);o&&"function"==typeof e&&e.call(o,n)}))}Array.from(f).forEach((function(t){var e;r(t,!1),s({type:"audio",style:"inline",src:(e=t.querySelector("source"),e?e.src:null)})}));function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}m(".jonnitto-prettyembed--video.jonnitto-prettyembed--inline video",(function(t){var e=this;t.preventDefault(),r(this,!0,(function(){var t;s({type:"video",style:"inline",title:e.ariaLabel,src:(t=e.querySelector("source"),t?t.src:null)})}))}));var y=document.documentElement,b=document.body,h="jonnitto-prettyembed",g="".concat(h,"__lightbox"),E=g,L="-".concat(g),S=y.classList,A="".concat(h,"__inner"),T="".concat(h,"__close"),w="".concat(h,"__content"),H=document.createElement("div");H.className=g,H.innerHTML='\n<div class="'.concat(A,'">\n    <button type="button" class="').concat(T,'">&times;</button>\n    <div id="').concat(E,'" class="').concat(h," ").concat(w,'"></div>\n</div>');var _=!1,j=null;function q(){_.className="".concat(h," ").concat(w),_.removeAttribute("style"),_.innerHTML=""}function C(t,e){return _||(b.appendChild(H),_=document.getElementById(E)),q(),"object"!=v(t)&&(t=t?[t]:[]),t.forEach((function(t){_.classList.add("".concat(h,"--").concat(t))})),e&&(_.style.paddingTop=e),_}function M(t){clearTimeout(j),j=setTimeout((function(){"function"==typeof t&&t(),S.add(L)}),100)}function N(){S.remove(L),_&&(clearTimeout(j),j=setTimeout(q,300))}function x(t,e){"function"==typeof e&&"string"==typeof t&&m(t,e)}m(".".concat(w),(function(t){t.stopImmediatePropagation()})),m(".".concat(g),N),m(".".concat(T),N),y.addEventListener("keyup",(function(t){27==t.keyCode&&S.contains(L)&&N()}));var k,D="jonnitto-prettyembed";x(".".concat(D,"--video.").concat(D,"--lightbox video"),(function(t){var e=this;t.preventDefault(),clearTimeout(k),l();var n=C("video",!1).appendChild(this.cloneNode(!0));null==this.dataset.controls&&Array.from(this.parentNode.children).forEach((function(t){t==e||t.classList.contains("".concat(D,"__preview"))||n.parentNode.appendChild(t.cloneNode(!0))})),M((function(){var t;r(n),e.dataset.init||(e.dataset.init=!0,s({type:"video",style:"lightbox",title:e.ariaLabel,src:(t=e.querySelector("source"),t?t.src:null)}))})),k=setTimeout((function(){n.play()}),500)}));var I="jonnitto-prettyembed";function P(t){var e=t.dataset,n=null!=e.fs;return!!e.embed&&'<iframe src="'.concat(e.embed,'" ').concat(n?"allowfullscreen ":"",'frameborder="0" allow="').concat(n?"fullscreen; ":"",'accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"></iframe>')}function R(t){var e=t.querySelector("img");return{node:e||null,src:e?e.getAttribute("src"):null}}function W(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"56.25%";if(t.dataset.ratio)return t.dataset.ratio;var n=R(t);if(!n.node)return e;var o=parseInt(n.node.naturalHeight)/parseInt(n.node.naturalWidth)*100;return"number"!=typeof o?e:o+"%"}function z(t,e,n){if(B(t)){var o=P(t),a=R(t);if(!o)return;var c=function(t,e){if("object"===v(t)&&"string"==typeof e){var n=t,o=n.tagName,a=new RegExp("^<"+o,"i"),c=new RegExp(o+">$","i"),i="<"+e,r=e+">",u=document.createElement("div");u.innerHTML=n.outerHTML.replace(a,i).replace(c,r);var l=u.firstChild;return t.parentNode.replaceChild(l,t),l}}(t,"div");c.classList.add(e),c.style.paddingTop=W(t),c.innerHTML=o,a.src&&c.setAttribute("data-img",a.src),s({type:n,style:"inline",title:t.ariaLabel,src:t.dataset.embed})}}function B(t){var e=t.dataset.gdpr;return!e||!(!e||!confirm(e))&&(t.removeAttribute("data-gdpr"),!0)}function J(t){x("a.".concat(I,"--").concat(t,".").concat(I,"--lightbox"),(function(e){var n=this,o=P(this);if(o&&(e.preventDefault(),B(this))){var a=W(this);C([t,"iframe"],a).innerHTML=o,M((function(){n.dataset.init||(n.dataset.init=!0,s({type:t,style:"lightbox",title:n.ariaLabel,src:n.dataset.embed}))}))}}))}function O(t){var e="a.".concat(I,"--").concat(t,".").concat(I,"--inline"),n="".concat(I,"--play");m(e,(function(e){e.preventDefault(),z(this,n,t)}))}function $(t){var e=t.getAttribute("src");t.naturalHeight<=90&&t.naturalWidth<=120&&-1==e.indexOf("/default.jpg")&&(e=e.replace("mqdefault","default").replace("hqdefault","mqdefault").replace("sddefault","hqdefault").replace("maxresdefault","sddefault"),t.setAttribute("src",e),setTimeout((function(){t.onload=function(){$(t)}}),10),setTimeout((function(){$(t)}),5e3))}O("vimeo"),J("vimeo"),O("youtube"),J("youtube"),window.addEventListener("load",(function(){!function(t){void 0===t&&(t=document.querySelectorAll("img.jonnitto-prettyembed__youtube-preview"));for(var e=t.length-1;e>=0;e--)$(t[e])}()}))}();
//# sourceMappingURL=Main.js.map
