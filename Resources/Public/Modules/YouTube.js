import{c as w,d as v}from"./chunk-TTJLV6PQ.js";var f="prettyembed";function x(s){s.directive("prettyembedyoutube",(p,{modifiers:l,expression:o},{evaluate:n})=>{let i=l.includes("lightbox")?"lightbox":"inline",u={slim:l.includes("slim"),style:i,...n(o||"{}")};I({element:p,Alpine:s,options:u})})}function I({element:s,Alpine:p,options:l}){let o="YouTube",{video:n,playlist:i,style:h,slim:u,loop:g}=l,d={playerVars:{autoplay:1,modestbranding:1,playsinline:1,rel:0,showinfo:0,controls:u?0:1,loop:g?1:0}};n&&(d.videoId=n),i&&(i.startsWith("PL")||(i="PL"+i),d.playerVars.listType="playlist",d.playerVars.list=i);let b=window.localStorage,m=`jonnittoprettyembed_gdpr_${o.toLowerCase()}`,P={title:l.title,loaded:!1,playing:!1,lightbox:h==="lightbox"?!1:null,gdpr:l.gdpr&&b.getItem(m)!=="true"?"needCheck":"isAccepted"},t=null;p.bind(s,{"x-data"(){return{...P,init(){this.ligtbox!==null&&this.$watch("lightbox",(e,c)=>{!e&&e!==c&&this.pause()})},acceptGdpr(){b.setItem(m,"true"),this.$dispatch("prettyembedAcceptGdpr",o),this.load()},play(){t?.playVideo()},pause(){t?.pauseVideo()},load(e){if(e&&e.preventDefault(),this.gdpr!="isAccepted"){this.gdpr="isOpen";return}if(this.lightbox!==null&&(this.lightbox=!0),this.loaded){this.play();return}w(()=>{let c=this.$refs?.youtube||s,y=()=>{let a=t.getVideoUrl(),{title:r,author:T,video_id:$,video_quality:A,list:D}=t.getVideoData();return{type:o,style:h,title:r,author:T,videoUrl:a,videoID:$,quality:A,playlistID:D||null}};t=new YT.Player(c,{...d,events:{onStateChange:({data:a})=>{let r=t.getCurrentTime();if(a===YT.PlayerState.PLAYING){this.$dispatch("prettyembedPauseInternal",s),this.loaded=!0,this.playing=!0,this.$dispatch(f,{event:"play",currentTime:r,...y()});return}if(a===YT.PlayerState.PAUSED){this.playing=!1,this.$dispatch(f,{event:"pause",currentTime:r,...y()});return}a===YT.PlayerState.ENDED&&(this.playing=!1,!g&&!this.lightbox&&!v()&&this.reset(),this.$dispatch(f,{event:"finished",currentTime:r,...y()}))}}})})},reset(){t&&(t?.stopVideo(),t.destroy(),t=null,this.loaded=!1,this.playing=!1)}}},"@prettyembedAcceptGdpr.window"({detail:e}){e==o&&(this.gdpr="isAccepted")},"@prettyembedPauseInternal.window"({detail:e}){e!=this.$root&&this.pause()}})}window.addEventListener("alpine:init",()=>{window.Alpine.plugin(x)});
