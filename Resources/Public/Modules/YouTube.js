import{c as m}from"./chunk-LOKNYTE4.js";var f="prettyembed";function w(s){s.directive("prettyembedyoutube",(p,{modifiers:l,expression:o},{evaluate:n})=>{let i=l.includes("lightbox")?"lightbox":"inline",h={slim:l.includes("slim"),style:i,...n(o||"{}")};D({element:p,Alpine:s,options:h})})}function D({element:s,Alpine:p,options:l}){let o="YouTube",{video:n,playlist:i,style:u,slim:h,loop:v}=l,d={playerVars:{autoplay:1,modestbranding:1,playsinline:1,rel:0,showinfo:0,controls:h?0:1,loop:v?1:0}};n&&(d.videoId=n),i&&(i.startsWith("PL")||(i="PL"+i),d.playerVars.listType="playlist",d.playerVars.list=i);let g=window.localStorage,b=`jonnittoprettyembed_gdpr_${o.toLowerCase()}`,P={title:l.title,loaded:!1,playing:!1,lightbox:u==="lightbox"?!1:null,gdpr:l.gdpr&&g.getItem(b)!=="true"?"needCheck":"isAccepted"},t=null;p.bind(s,{"x-data"(){return{...P,init(){this.ligtbox!==null&&this.$watch("lightbox",(e,c)=>{!e&&e!==c&&this.pause()})},acceptGdpr(){g.setItem(b,"true"),this.$dispatch("prettyembedAcceptGdpr",o),this.load()},play(){t?.playVideo()},pause(){t?.pauseVideo()},load(e){if(e&&e.preventDefault(),this.gdpr!="isAccepted"){this.gdpr="isOpen";return}if(this.lightbox!==null&&(this.lightbox=!0),this.loaded){this.play();return}m(()=>{let c=this.$refs?.youtube||s,y=()=>{let a=t.getVideoUrl(),{title:r,author:x,video_id:T,video_quality:$,list:A}=t.getVideoData();return{type:o,style:u,title:r,author:x,videoUrl:a,videoID:T,quality:$,playlistID:A||null}};t=new YT.Player(c,{...d,events:{onStateChange:({data:a})=>{let r=t.getCurrentTime();if(a===YT.PlayerState.PLAYING){this.$dispatch("prettyembedPause",s),this.loaded=!0,this.playing=!0,this.$dispatch(f,{event:"play",currentTime:r,...y()});return}if(a===YT.PlayerState.PAUSED){this.playing=!1,this.$dispatch(f,{event:"pause",currentTime:r,...y()});return}if(a===YT.PlayerState.ENDED){this.playing=!1,this.$dispatch(f,{event:"finished",currentTime:r,...y()});return}}}})})},reset(){t&&(t?.stopVideo(),t.destroy(),t=null,this.loaded=!1,this.playing=!1)}}},"@prettyembedAcceptGdpr.window"({detail:e}){e==o&&(this.gdpr="isAccepted")},"@prettyembedReset.window"(){this.reset()},"@prettyembedPause.window"({detail:e}){e!=this.$root&&this.pause()}})}window.addEventListener("alpine:init",()=>{window.Alpine.plugin(w)});
