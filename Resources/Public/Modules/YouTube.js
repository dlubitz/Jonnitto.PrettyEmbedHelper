import{c as m}from"./chunk-LOKNYTE4.js";var f="prettyembed";function w(s){s.directive("prettyembedyoutube",(p,{modifiers:l,expression:a},{evaluate:n})=>{let i=l.includes("lightbox")?"lightbox":"inline",h={slim:l.includes("slim"),style:i,...n(a||"{}")};D({element:p,Alpine:s,options:h})})}function D({element:s,Alpine:p,options:l}){let a="YouTube",{video:n,playlist:i,style:u,slim:h,loop:v}=l,d={playerVars:{autoplay:1,modestbranding:1,playsinline:1,rel:0,showinfo:0,controls:h?0:1,loop:v?1:0}};n&&(d.videoId=n),i&&(i.startsWith("PL")||(i="PL"+i),d.playerVars.listType="playlist",d.playerVars.list=i);let g=window.localStorage,b=`jonnittoprettyembed_gdpr_${a.toLowerCase()}`,P={title:l.title,loaded:!1,playing:!1,lightbox:u==="lightbox"?!1:null,gdpr:l.gdpr&&g.getItem(b)!=="true"?"needCheck":"isAccepted"},t=null;p.bind(s,{"x-data"(){return{...P,init(){this.ligtbox!==null&&this.$watch("lightbox",(e,c)=>{!e&&e!==c&&this.pause()})},acceptGdpr(){g.setItem(b,"true"),this.$dispatch("prettyembedAcceptGdpr",a),this.load()},play(){t?.playVideo()},pause(){t?.pauseVideo()},load(e){if(e&&e.preventDefault(),this.gdpr!="isAccepted"){this.gdpr="isOpen";return}if(this.lightbox!==null&&(this.lightbox=!0),this.loaded){this.play();return}m(()=>{let c=this.$refs?.youtube||s,y=()=>{let o=t.getVideoUrl(),{title:r,author:x,video_id:T,video_quality:$,list:A}=t.getVideoData();return{type:a,style:u,title:r,author:x,videoUrl:o,videoID:T,quality:$,playlistID:A||null}};t=new YT.Player(c,{...d,events:{onStateChange:({data:o})=>{let r=t.getCurrentTime();if(o===YT.PlayerState.PLAYING){this.$dispatch("prettyembedPauseInternal",s),this.loaded=!0,this.playing=!0,this.$dispatch(f,{event:"play",currentTime:r,...y()});return}if(o===YT.PlayerState.PAUSED){this.playing=!1,this.$dispatch(f,{event:"pause",currentTime:r,...y()});return}if(o===YT.PlayerState.ENDED){this.playing=!1,this.$dispatch(f,{event:"finished",currentTime:r,...y()});return}}}})})},reset(){t&&(t?.stopVideo(),t.destroy(),t=null,this.loaded=!1,this.playing=!1)}}},"@prettyembedAcceptGdpr.window"({detail:e}){e==a&&(this.gdpr="isAccepted")},"@prettyembedPauseInternal.window"({detail:e}){e!=this.$root&&this.pause()}})}window.addEventListener("alpine:init",()=>{window.Alpine.plugin(w)});
