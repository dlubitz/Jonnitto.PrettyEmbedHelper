import{a as h,b as m,d as w}from"./chunk-FQ54N5TY.js";function b(i){i.directive("prettyembedvimeo",(n,{modifiers:o,expression:s},{evaluate:r})=>{let d=o.includes("lightbox")?"lightbox":"inline",p=o.includes("slim"),c={style:d,slim:p,...r(s||"{}")};V({element:n,Alpine:i,options:c})})}function V({element:i,Alpine:n,options:o}){let s="Vimeo",{style:r,slim:d,videoId:p,color:c,gdpr:v}=o,x={id:p,color:c,autopip:!0,autoplay:!0,pip:!0,portrait:!1,responsive:!1,title:!1,byline:!1,background:!1,autopause:!1,controls:!d},g=window.localStorage,y=`jonnittoprettyembed_gdpr_${s.toLowerCase()}`,$={loaded:!1,playing:!1,lightbox:r==="lightbox"?!1:null,gdpr:v&&g.getItem(y)!=="true"?"needCheck":"isAccepted"},t=null;n.bind(i,{":class"(){return this.playing&&m},"x-data"(){return{...$,init(){this.lightbox!==null&&this.$watch("lightbox",(e,u)=>{!e&&e!==u&&this.pause()})},acceptGdpr(){g.setItem(y,"true"),this.$dispatch("prettyEmbedAcceptGdpr",s),this.load()},play(){t?.play()},pause(){t?.pause()},load(e){if(e&&e.preventDefault(),this.gdpr!="isAccepted"){this.gdpr="isOpen";return}if(this.lightbox!==null&&(this.lightbox=!0),this.loaded){this.play();return}w(()=>{let u=this.$refs.target||i;t=new Vimeo.Player(u,x);let f=async a=>{let E=[t.getVideoTitle(),t.getVideoId(),t.getVideoUrl(),t.getCurrentTime(),t.getEnded()],l=await Promise.allSettled(E);return l[4].value&&(a="finished"),{event:a,type:s,style:r,title:l[0].value,id:l[1].value,url:l[2].value,currentTime:l[3].value}};t.on("play",async()=>{let a=await f("play");this.$dispatch("prettyEmbedPause",i),this.loaded=!0,this.playing=!0,this.$dispatch(h,a)}),t.on("pause",async()=>{let a=await f("pause");this.playing=!1,this.$dispatch(h,a)})})},async reset(){t&&(await this.pause(),await t.destroy(),t=null,this.loaded=!1,this.playing=!1)}}},"@prettyEmbedAcceptGdpr.window"({detail:e}){e==s&&(this.gdpr="isAccepted")},"@prettyEmbedReset.window"(){this.reset()},"@prettyEmbedPause.window"({detail:e}){e!=this.$root&&this.pause()}})}window.addEventListener("alpine:init",()=>{window.Alpine.plugin(b)});
